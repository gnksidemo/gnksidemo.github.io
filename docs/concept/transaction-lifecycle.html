<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://docs.gnfd.io/docs/concept/transaction-lifecycle.html"><meta property="og:site_name" content="BNB Greenfield"><meta property="og:title" content="Transaction Lifecycle"><meta property="og:description" content="This document describes the lifecycle of a transaction from creation to committed state changes. Transaction definition is described in a different doc (https://github.com/bnb-c..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2023-03-22T04:17:31.000Z"><meta property="article:modified_time" content="2023-03-22T04:17:31.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Transaction Lifecycle","image":[""],"dateModified":"2023-03-22T04:17:31.000Z","author":[]}</script><title>Transaction Lifecycle | BNB Greenfield</title><meta name="description" content="This document describes the lifecycle of a transaction from creation to committed state changes. Transaction definition is described in a different doc (https://github.com/bnb-c...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-28d8b981.css" as="style"><link rel="stylesheet" href="/assets/style-28d8b981.css">
    <link rel="modulepreload" href="/assets/app-07a3b8c6.js"><link rel="modulepreload" href="/assets/framework-a045178c.js"><link rel="modulepreload" href="/assets/transaction-lifecycle.html-c86a5c1a.js"><link rel="modulepreload" href="/assets/transaction-lifecycle.html-20ac0753.js"><link rel="prefetch" href="/assets/index.html-469dca30.js" as="script"><link rel="prefetch" href="/assets/get-started.html-33df32c6.js" as="script"><link rel="prefetch" href="/assets/release-note.html-3aeaee8e.js" as="script"><link rel="prefetch" href="/assets/resources.html-6199b970.js" as="script"><link rel="prefetch" href="/assets/index.html-55fb2645.js" as="script"><link rel="prefetch" href="/assets/events.html-bdcbc1ec.js" as="script"><link rel="prefetch" href="/assets/grpc_rest.html-e9626123.js" as="script"><link rel="prefetch" href="/assets/sdk.html-ca140ca1.js" as="script"><link rel="prefetch" href="/assets/accounts.html-b0c80824.js" as="script"><link rel="prefetch" href="/assets/billing-payment.html-cf967db9.js" as="script"><link rel="prefetch" href="/assets/data-availability.html-d275766f.js" as="script"><link rel="prefetch" href="/assets/gas-fees.html-f1f399ba.js" as="script"><link rel="prefetch" href="/assets/key-management.html-bb5d1446.js" as="script"><link rel="prefetch" href="/assets/programmability.html-1a6699ef.js" as="script"><link rel="prefetch" href="/assets/index.html-cfd75339.js" as="script"><link rel="prefetch" href="/assets/simple-storage-svc-model .html-00532725.js" as="script"><link rel="prefetch" href="/assets/index.html-a3c054b7.js" as="script"><link rel="prefetch" href="/assets/quick-start.html-718589b7.js" as="script"><link rel="prefetch" href="/assets/index.html-13217e7d.js" as="script"><link rel="prefetch" href="/assets/index.html-4f18c6cb.js" as="script"><link rel="prefetch" href="/assets/overview.html-78f8405e.js" as="script"><link rel="prefetch" href="/assets/index.html-992307c5.js" as="script"><link rel="prefetch" href="/assets/ecosystem-player.html-9da577d5.js" as="script"><link rel="prefetch" href="/assets/overview.html-0db8d1d6.js" as="script"><link rel="prefetch" href="/assets/token-economics.html-9ae9aed3.js" as="script"><link rel="prefetch" href="/assets/index.html-dd4f1aed.js" as="script"><link rel="prefetch" href="/assets/overview.html-ca187127.js" as="script"><link rel="prefetch" href="/assets/index.html-824ce066.js" as="script"><link rel="prefetch" href="/assets/bank.html-8f4b857c.js" as="script"><link rel="prefetch" href="/assets/bridge.html-d26b0012.js" as="script"><link rel="prefetch" href="/assets/governance.html-87057919.js" as="script"><link rel="prefetch" href="/assets/key-management.html-cdb355fb.js" as="script"><link rel="prefetch" href="/assets/payment.html-b0352746.js" as="script"><link rel="prefetch" href="/assets/storage-provider.html-66e24e7a.js" as="script"><link rel="prefetch" href="/assets/storage.html-8a990613.js" as="script"><link rel="prefetch" href="/assets/validator-staking.html-61aeb5cf.js" as="script"><link rel="prefetch" href="/assets/billing-and-payment.html-7d9bd116.js" as="script"><link rel="prefetch" href="/assets/consensus-and-staking.html-c1c39335.js" as="script"><link rel="prefetch" href="/assets/cross-chain.html-d3d0a932.js" as="script"><link rel="prefetch" href="/assets/data-availability-challenge.html-4d89c1c8.js" as="script"><link rel="prefetch" href="/assets/governance.html-c50e951b.js" as="script"><link rel="prefetch" href="/assets/permission.html-71ee8801.js" as="script"><link rel="prefetch" href="/assets/index.html-7012d026.js" as="script"><link rel="prefetch" href="/assets/storage-module.html-2c4e78ad.js" as="script"><link rel="prefetch" href="/assets/storage-provider.html-ebab1010.js" as="script"><link rel="prefetch" href="/assets/world-state.html-5adbfff5.js" as="script"><link rel="prefetch" href="/assets/become-testnet-validator.html-e47c54b7.js" as="script"><link rel="prefetch" href="/assets/interact-node.html-86eb18dd.js" as="script"><link rel="prefetch" href="/assets/index.html-cc7569b1.js" as="script"><link rel="prefetch" href="/assets/run-local-network.html-3f311957.js" as="script"><link rel="prefetch" href="/assets/run-mainnet-node.html-29234042.js" as="script"><link rel="prefetch" href="/assets/run-testnet-node.html-7474d8c1.js" as="script"><link rel="prefetch" href="/assets/404.html-8865ce6a.js" as="script"><link rel="prefetch" href="/assets/index.html-371be8f3.js" as="script"><link rel="prefetch" href="/assets/index.html-80c12cff.js" as="script"><link rel="prefetch" href="/assets/get-started.html-a5c53275.js" as="script"><link rel="prefetch" href="/assets/release-note.html-6207f6e7.js" as="script"><link rel="prefetch" href="/assets/resources.html-1edba3d6.js" as="script"><link rel="prefetch" href="/assets/index.html-ad3096ed.js" as="script"><link rel="prefetch" href="/assets/events.html-43554880.js" as="script"><link rel="prefetch" href="/assets/grpc_rest.html-57270df9.js" as="script"><link rel="prefetch" href="/assets/sdk.html-2e633fc5.js" as="script"><link rel="prefetch" href="/assets/accounts.html-613dcebf.js" as="script"><link rel="prefetch" href="/assets/billing-payment.html-f82549e3.js" as="script"><link rel="prefetch" href="/assets/data-availability.html-07e74068.js" as="script"><link rel="prefetch" href="/assets/gas-fees.html-681e5788.js" as="script"><link rel="prefetch" href="/assets/key-management.html-9ba75dfe.js" as="script"><link rel="prefetch" href="/assets/programmability.html-e03d6585.js" as="script"><link rel="prefetch" href="/assets/index.html-1f50686c.js" as="script"><link rel="prefetch" href="/assets/simple-storage-svc-model .html-ebff64de.js" as="script"><link rel="prefetch" href="/assets/index.html-cc29ea18.js" as="script"><link rel="prefetch" href="/assets/quick-start.html-9b377f76.js" as="script"><link rel="prefetch" href="/assets/index.html-c0e11f76.js" as="script"><link rel="prefetch" href="/assets/index.html-5c748056.js" as="script"><link rel="prefetch" href="/assets/overview.html-cdde6b76.js" as="script"><link rel="prefetch" href="/assets/index.html-2138fc86.js" as="script"><link rel="prefetch" href="/assets/ecosystem-player.html-4e998573.js" as="script"><link rel="prefetch" href="/assets/overview.html-e3d61f37.js" as="script"><link rel="prefetch" href="/assets/token-economics.html-c7b1f798.js" as="script"><link rel="prefetch" href="/assets/index.html-eb177e9d.js" as="script"><link rel="prefetch" href="/assets/overview.html-f19d4825.js" as="script"><link rel="prefetch" href="/assets/index.html-e6c47454.js" as="script"><link rel="prefetch" href="/assets/bank.html-48e32b23.js" as="script"><link rel="prefetch" href="/assets/bridge.html-57609f77.js" as="script"><link rel="prefetch" href="/assets/governance.html-4c2e25ed.js" as="script"><link rel="prefetch" href="/assets/key-management.html-619ed5e4.js" as="script"><link rel="prefetch" href="/assets/payment.html-75b9a8db.js" as="script"><link rel="prefetch" href="/assets/storage-provider.html-a77cb7d7.js" as="script"><link rel="prefetch" href="/assets/storage.html-bbfb1497.js" as="script"><link rel="prefetch" href="/assets/validator-staking.html-d43eb5bb.js" as="script"><link rel="prefetch" href="/assets/billing-and-payment.html-df2e06b8.js" as="script"><link rel="prefetch" href="/assets/consensus-and-staking.html-fba96138.js" as="script"><link rel="prefetch" href="/assets/cross-chain.html-855427d9.js" as="script"><link rel="prefetch" href="/assets/data-availability-challenge.html-b92fb871.js" as="script"><link rel="prefetch" href="/assets/governance.html-31c73615.js" as="script"><link rel="prefetch" href="/assets/permission.html-a115d3c3.js" as="script"><link rel="prefetch" href="/assets/index.html-91535ba8.js" as="script"><link rel="prefetch" href="/assets/storage-module.html-24d92cac.js" as="script"><link rel="prefetch" href="/assets/storage-provider.html-d8dd68d1.js" as="script"><link rel="prefetch" href="/assets/world-state.html-647f321d.js" as="script"><link rel="prefetch" href="/assets/become-testnet-validator.html-490c3ff4.js" as="script"><link rel="prefetch" href="/assets/interact-node.html-c37c24b6.js" as="script"><link rel="prefetch" href="/assets/index.html-af0b6faf.js" as="script"><link rel="prefetch" href="/assets/run-local-network.html-7fac0d7b.js" as="script"><link rel="prefetch" href="/assets/run-mainnet-node.html-bc02052a.js" as="script"><link rel="prefetch" href="/assets/run-testnet-node.html-05399849.js" as="script"><link rel="prefetch" href="/assets/404.html-8dc761d7.js" as="script"><link rel="prefetch" href="/assets/index.html-483faaac.js" as="script"><link rel="prefetch" href="/assets/auto-ba5ecab5.js" as="script"><link rel="prefetch" href="/assets/index-8764208e.js" as="script"><link rel="prefetch" href="/assets/flowchart-35969cab.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-f403537b.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-a794bb63.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-d92a2fc9.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-224f94d9.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-e5069ce0.js" as="script"><link rel="prefetch" href="/assets/search.esm-2c3fba7d.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-2d3cf4cb.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-6e6cbe40.js" as="script"><link rel="prefetch" href="/assets/SearchResult-65d8d2c8.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="BNB Greenfield"><!----><span class="site-name hide-in-pad">BNB Greenfield</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="Home"><span class="font-icon icon iconfont icon-home" style=""></span>Home<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/introduction/overview.html" class="nav-link" aria-label="Docs"><!---->Docs<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/bnb-chain/greenfield-docs" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button class="search-pro-button" role="search" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">Search</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-advance" style=""></span><span class="title">Introduction</span><span class="arrow end"></span></button><!----></section></li><li><!--[--><a href="/docs/get-started.html" class="nav-link sidebar-link sidebar-page" aria-label="Get Started"><span class="font-icon icon iconfont icon-creative" style=""></span>Get Started<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="font-icon icon iconfont icon-discover" style=""></span><span class="title">Core Concept</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/docs/concept/accounts.html" class="nav-link sidebar-link sidebar-page" aria-label="Accounts"><!---->Accounts<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/concept/key-management.html" class="nav-link sidebar-link sidebar-page" aria-label="Key Management"><!---->Key Management<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/concept/gas-fees.html" class="nav-link sidebar-link sidebar-page" aria-label="Gas and Fees"><!---->Gas and Fees<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/concept/billing-payment.html" class="nav-link sidebar-link sidebar-page" aria-label="Billing and Payment"><!---->Billing and Payment<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/concept/simple-storage-svc-model%20.html" class="nav-link sidebar-link sidebar-page" aria-label="Simple Storage Service Model"><!---->Simple Storage Service Model<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/concept/data-availability.html" class="nav-link sidebar-link sidebar-page" aria-label="Data Integrity and Availability"><!---->Data Integrity and Availability<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/concept/programmability.html" class="nav-link sidebar-link sidebar-page" aria-label="Programmability"><!---->Programmability<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/docs/concept/transaction-lifecycle.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Transaction Lifecycle"><!---->Transaction Lifecycle<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#creation" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Creation"><!---->Creation<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#transaction-creation" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Transaction Creation"><!---->Transaction Creation<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#addition-to-mempool" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Addition to Mempool"><!---->Addition to Mempool<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#types-of-checks" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Types of Checks"><!---->Types of Checks<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#decoding" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Decoding"><!---->Decoding<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#validatebasic" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ValidateBasic"><!---->ValidateBasic<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#antehandler" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="AnteHandler"><!---->AnteHandler<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#gas" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Gas"><!---->Gas<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#discard-or-addition-to-mempool" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Discard or Addition to Mempool"><!---->Discard or Addition to Mempool<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#inclusion-in-a-block" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Inclusion in a Block"><!---->Inclusion in a Block<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#state-changes" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="State Changes"><!---->State Changes<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#delivertx" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="DeliverTx"><!---->DeliverTx<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#commit" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Commit"><!---->Commit<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-any" style=""></span><span class="title">Greenfield Blockchain</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-storage" style=""></span><span class="title">Storage Provider</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-app" style=""></span><span class="title">Build Dapps</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-generic" style=""></span><span class="title">API Reference</span><span class="arrow end"></span></button><!----></section></li><li><!--[--><a href="/docs/resources.html" class="nav-link sidebar-link sidebar-page" aria-label="Resources"><span class="font-icon icon iconfont icon-material" style=""></span>Resources<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/release-note.html" class="nav-link sidebar-link sidebar-page" aria-label="Release Note"><span class="font-icon icon iconfont icon-proposal" style=""></span>Release Note<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-ask" style=""></span><span class="title">FAQ</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Transaction Lifecycle</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-03-22T04:17:31.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 8 min</span><meta property="timeRequired" content="PT8M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">On This Page<button class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#creation" class="router-link-active router-link-exact-active toc-link level2">Creation</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#transaction-creation" class="router-link-active router-link-exact-active toc-link level3">Transaction Creation</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#addition-to-mempool" class="router-link-active router-link-exact-active toc-link level2">Addition to Mempool</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#types-of-checks" class="router-link-active router-link-exact-active toc-link level3">Types of Checks</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#decoding" class="router-link-active router-link-exact-active toc-link level3">Decoding</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#validatebasic" class="router-link-active router-link-exact-active toc-link level3">ValidateBasic</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#antehandler" class="router-link-active router-link-exact-active toc-link level3">AnteHandler</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#gas" class="router-link-active router-link-exact-active toc-link level3">Gas</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#discard-or-addition-to-mempool" class="router-link-active router-link-exact-active toc-link level3">Discard or Addition to Mempool</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#inclusion-in-a-block" class="router-link-active router-link-exact-active toc-link level2">Inclusion in a Block</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#state-changes" class="router-link-active router-link-exact-active toc-link level2">State Changes</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#delivertx" class="router-link-active router-link-exact-active toc-link level3">DeliverTx</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/concept/transaction-lifecycle.html#commit" class="router-link-active router-link-exact-active toc-link level3">Commit</a></li><!----><!--]--></ul><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="transaction-lifecycle" tabindex="-1"><a class="header-anchor" href="#transaction-lifecycle" aria-hidden="true">#</a> Transaction Lifecycle</h1><p>This document describes the lifecycle of a transaction from creation to committed state changes. Transaction definition is described in a <a href="https://github.com/bnb-chain/greenfield-cosmos-sdk/blob/master/docs/core/transactions.md" target="_blank" rel="noopener noreferrer">different doc<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. The transaction will be referred to as <code>Tx</code>.</p><h2 id="creation" tabindex="-1"><a class="header-anchor" href="#creation" aria-hidden="true">#</a> Creation</h2><h3 id="transaction-creation" tabindex="-1"><a class="header-anchor" href="#transaction-creation" aria-hidden="true">#</a> Transaction Creation</h3><p>One of the main application interfaces is the command-line interface. The transaction <code>Tx</code> can be created by the user inputting a command in the following format from the <a href="/cli/" class="">command-line</a>, providing the type of transaction in <code>[command]</code>, arguments in <code>[args]</code>, and configurations such as gas prices in <code>[flags]</code>:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>gnfd tx <span class="token punctuation">[</span>command<span class="token punctuation">]</span> <span class="token punctuation">[</span>args<span class="token punctuation">]</span> <span class="token punctuation">[</span>flags<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>This command will automatically <strong>create</strong> the transaction, <strong>sign</strong> it using the account&#39;s private key, and <strong>broadcast</strong> it to the specified peer node.</p><p>There are several required and optional flags for transaction creation. The <code>--from</code> flag specifies which <a href="/docs/concept/accounts.html" class="">account</a> the transaction is originating from. For example, if the transaction is sending coins, the funds will be drawn from the specified <code>from</code> address.</p><h4 id="gas-and-fees" tabindex="-1"><a class="header-anchor" href="#gas-and-fees" aria-hidden="true">#</a> Gas and Fees</h4><p>Additionally, there are several <a href="/cli/" class="">flags</a> users can use to indicate how much they are willing to pay in <a href="/docs/concept/gas-fees.html" class="">fees</a>:</p><ul><li><code>--gas</code> refers to how much <a href="/docs/concept/gas-fees.html" class="">gas</a>. Different from other cosmos blockchain where gas represents computational resources, on greenfield blockchain, the gas of a transaction is predefined. It is suggested to be estimated by providing <code>auto</code> as the value for <code>--gas</code>.</li><li><code>--gas-prices</code> specifies how much the user is willing to pay per unit of gas, which can be one or multiple denominations of tokens. For example, <code>--gas-prices=5000000000BNB</code> means the user is willing to pay 5Gwei BNB per unit of gas.</li><li><code>--fees</code> specifies how much in fees the user is willing to pay in total.</li><li><code>--timeout-height</code> specifies a block timeout height to prevent the tx from being committed past a certain height.</li></ul><p>The ultimate value of the fees paid is equal to the gas multiplied by the gas prices. In other words, <code>fees = ceil(gas * gasPrices)</code>. Thus, since fees can be calculated using gas prices and vice versa, the users specify only one of the two.</p><p>Later, validators decide whether to include the transaction in their block by comparing the given or calculated <code>gas-prices</code> to their local <code>min-gas-prices</code>. <code>Tx</code> will be rejected if its <code>gas-prices</code> is not high enough, so users are incentive to pay more.</p><h4 id="cli-example" tabindex="-1"><a class="header-anchor" href="#cli-example" aria-hidden="true">#</a> CLI Example</h4><p>Users of the application <code>app</code> can enter the following command into their CLI to generate a transaction to send 1000wei BNB from a <code>senderAddress</code> to a <code>recipientAddress</code>.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>gnfd tx send <span class="token operator">&lt;</span>recipientAddress<span class="token operator">&gt;</span> 1000BNB <span class="token parameter variable">--from</span> <span class="token operator">&lt;</span>senderAddress<span class="token operator">&gt;</span> <span class="token parameter variable">--gas</span> auto
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="other-transaction-creation-methods" tabindex="-1"><a class="header-anchor" href="#other-transaction-creation-methods" aria-hidden="true">#</a> Other Transaction Creation Methods</h4><p>The command-line is an easy way to interact with an application, but <code>Tx</code> can also be created using a <a href="/docs/api-sdk/grpc_rest.html" class="">gRPC or REST interface</a> or some other entry point defined by the application developer. From the user&#39;s perspective, the interaction depends on the web interface or wallet they are using (e.g. creating <code>Tx</code> using <a href="https://lunie.io/#/" target="_blank" rel="noopener noreferrer">Lunie.io<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> and signing it with a Ledger Nano S).</p><h2 id="addition-to-mempool" tabindex="-1"><a class="header-anchor" href="#addition-to-mempool" aria-hidden="true">#</a> Addition to Mempool</h2><p>Each full-node (running Tendermint) that receives a <code>Tx</code> sends an <a href="https://docs.tendermint.com/master/spec/abci/abci.html#messages" target="_blank" rel="noopener noreferrer">ABCI message<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, <code>CheckTx</code>, to the application layer to check for validity, and receives an <code>abci.ResponseCheckTx</code>. If the <code>Tx</code> passes the checks, it is held in the nodes&#39;<a href="https://docs.tendermint.com/master/tendermint-core/mempool/" target="_blank" rel="noopener noreferrer"><strong>Mempool</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, an in-memory pool of transactions unique to each node, pending inclusion in a block - honest nodes will discard <code>Tx</code> if it is found to be invalid. Prior to consensus, nodes continuously check incoming transactions and gossip them to their peers.</p><h3 id="types-of-checks" tabindex="-1"><a class="header-anchor" href="#types-of-checks" aria-hidden="true">#</a> Types of Checks</h3><p>The full-nodes perform stateless, then stateful checks on <code>Tx</code> during <code>CheckTx</code>, with the goal to identify and reject an invalid transaction as early on as possible to avoid wasted computation.</p><p><strong><em>Stateless</em></strong> checks do not require nodes to access state - light clients or offline nodes can do them - and are thus less computationally expensive. Stateless checks include making sure addresses are not empty, enforcing non-negative numbers, and other logic specified in the definitions.</p><p><strong><em>Stateful</em></strong> checks validate transactions and messages based on a committed state. Examples include checking that the relevant values exist and can be transacted with, the address has sufficient funds, and the sender is authorized or has the correct ownership to transact. At any given moment, full-nodes typically have multiple versions of the application&#39;s internal state for different purposes. For example, nodes will execute state changes while in the process of verifying transactions, but still need a copy of the last committed state in order to answer queries - they should not respond using state with uncommitted changes.</p><p>In order to verify a <code>Tx</code>, full-nodes call <code>CheckTx</code>, which includes both <em>stateless</em> and <em>stateful</em> checks. Further validation happens later in the <a href="#delivertx"><code>DeliverTx</code></a> stage. <code>CheckTx</code> goes through several steps, beginning with decoding <code>Tx</code>.</p><h3 id="decoding" tabindex="-1"><a class="header-anchor" href="#decoding" aria-hidden="true">#</a> Decoding</h3><p>When <code>Tx</code> is received by the application from the underlying consensus engine (e.g. Tendermint), it is still in its encoded <code>[]byte</code> form and needs to be unmarshaled in order to be processed. Then, the <code>runTx</code> function is called to run in <code>runTxModeCheck</code> mode, meaning the function will run all checks but exit before executing messages and writing state changes.</p><h3 id="validatebasic" tabindex="-1"><a class="header-anchor" href="#validatebasic" aria-hidden="true">#</a> ValidateBasic</h3><p>Messages <code>sdk.Msg</code> are extracted from transactions (<code>Tx</code>). The <code>ValidateBasic</code> method of the <code>sdk.Msg</code> interface implemented by the module developer is run for each transaction. To discard obviously invalid messages, the <code>BaseApp</code> type calls the <code>ValidateBasic</code> method very early in the processing of the message in the <code>CheckTx</code> and <code>DeliverTx</code> transactions. <code>ValidateBasic</code> can include only <strong>stateless</strong> checks (the checks that do not require access to the state).</p><h3 id="antehandler" tabindex="-1"><a class="header-anchor" href="#antehandler" aria-hidden="true">#</a> AnteHandler</h3><p>After the ValidateBasic checks, the <code>AnteHandler</code>s are run. Technically, they are optional, but in practice, they are very often present to perform signature verification, gas calculation, fee deduction and other core operations related to blockchain transactions.</p><p>A copy of the cached context is provided to the <code>AnteHandler</code>, which performs limited checks specified for the transaction type. Using a copy allows the <code>AnteHandler</code> to do stateful checks for <code>Tx</code> without modifying the last committed state, and revert to the original if the execution fails.</p><h3 id="gas" tabindex="-1"><a class="header-anchor" href="#gas" aria-hidden="true">#</a> Gas</h3><p>The <code>Context</code>, which keeps a <code>GasMeter</code> that will track how much gas has been used during the execution of <code>Tx</code>, is initialized. The user-provided amount of gas for <code>Tx</code> is known as <code>GasWanted</code>. If <code>GasConsumed</code>, the amount of gas consumed so during execution, ever exceeds <code>GasWanted</code>, the execution will stop and the changes made to the cached copy of the state won&#39;t be committed. Otherwise, <code>CheckTx</code> sets <code>GasUsed</code> equal to <code>GasConsumed</code> and returns it in the result. After calculating the gas and fee values, validator-nodes check that the user-specified <code>gas-prices</code> is greater than their locally defined <code>min-gas-prices</code>.</p><h3 id="discard-or-addition-to-mempool" tabindex="-1"><a class="header-anchor" href="#discard-or-addition-to-mempool" aria-hidden="true">#</a> Discard or Addition to Mempool</h3><p>If at any point during <code>CheckTx</code> the <code>Tx</code> fails, it is discarded and the transaction lifecycle ends there. Otherwise, if it passes <code>CheckTx</code> successfully, the default protocol is to relay it to peer nodes and add it to the Mempool so that the <code>Tx</code> becomes a candidate to be included in the next block.</p><p>The <strong>mempool</strong> serves the purpose of keeping track of transactions seen by all full-nodes. Full-nodes keep a <strong>mempool cache</strong> of the last <code>mempool.cache_size</code> transactions they have seen, as a first line of defense to prevent replay attacks. Ideally, <code>mempool.cache_size</code> is large enough to encompass all the transactions in the full mempool. If the mempool cache is too small to keep track of all the transactions, <code>CheckTx</code> is responsible for identifying and rejecting replayed transactions.</p><p>Currently existing preventative measures include fees and a <code>sequence</code> (nonce) counter to distinguish replayed transactions from identical but valid ones. If an attacker tries to spam nodes with many copies of a <code>Tx</code>, full-nodes keeping a mempool cache will reject identical copies instead of running <code>CheckTx</code> on all of them. Even if the copies have incremented <code>sequence</code> numbers, attackers are disincentivized by the need to pay fees.</p><p>Validator nodes keep a mempool to prevent replay attacks, just as full-nodes do, but also use it as a pool of unconfirmed transactions in preparation of block inclusion. Note that even if a <code>Tx</code> passes all checks at this stage, it is still possible to be found invalid later on, because <code>CheckTx</code> does not fully validate the transaction (i.e. it does not actually execute the messages).</p><h2 id="inclusion-in-a-block" tabindex="-1"><a class="header-anchor" href="#inclusion-in-a-block" aria-hidden="true">#</a> Inclusion in a Block</h2><p>Consensus, the process through which validator nodes come to agreement on which transactions to accept, happens in <strong>rounds</strong>. Each round begins with a proposer creating a block of the most recent transactions and ends with <strong>validators</strong>, special full-nodes with voting power responsible for consensus, agreeing to accept the block or go with a <code>nil</code> block instead. Validator nodes execute the consensus algorithm, such as <a href="https://docs.tendermint.com/master/spec/consensus/consensus.html#terms" target="_blank" rel="noopener noreferrer">Tendermint BFT<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, confirming the transactions using ABCI requests to the application, in order to come to this agreement.</p><p>The first step of consensus is the <strong>block proposal</strong>. One proposer amongst the validators is chosen by the consensus algorithm to create and propose a block - in order for a <code>Tx</code> to be included, it must be in this proposer&#39;s mempool.</p><h2 id="state-changes" tabindex="-1"><a class="header-anchor" href="#state-changes" aria-hidden="true">#</a> State Changes</h2><p>The next step of consensus is to execute the transactions to fully validate them. All full-nodes that receive a block proposal from the correct proposer execute the transactions by calling the ABCI functions <code>BeginBlock</code>, <code>DeliverTx</code> for each transaction, and <code>EndBlock</code>. While each full-node runs everything locally, this process yields a single, unambiguous result, since the messages&#39; state transitions are deterministic and transactions are explicitly ordered in the block proposal.</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>		-----------------------
		|Receive Block Proposal|
		-----------------------
		          |
			  v
		-----------------------
		| BeginBlock	      |
		-----------------------
		          |
			  v
		-----------------------
		| DeliverTx(tx0)      |
		| DeliverTx(tx1)      |
		| DeliverTx(tx2)      |
		| DeliverTx(tx3)      |
		|	.	      |
		|	.	      |
		|	.	      |
		-----------------------
		          |
			  v
		-----------------------
		| EndBlock	      |
		-----------------------
		          |
			  v
		-----------------------
		| Consensus	      |
		-----------------------
		          |
			  v
		-----------------------
		| Commit	      |
		-----------------------
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="delivertx" tabindex="-1"><a class="header-anchor" href="#delivertx" aria-hidden="true">#</a> DeliverTx</h3><p>The <code>DeliverTx</code> ABCI function defined in <code>BaseApp</code> does the bulk of the state transitions: it is run for each transaction in the block in sequential order as committed to during consensus. Under the hood, <code>DeliverTx</code> is almost identical to <code>CheckTx</code> but calls the <code>runTx</code> function in deliver mode instead of check mode. Instead of using their <code>checkState</code>, full-nodes use <code>deliverState</code>:</p><ul><li><p><strong>Decoding:</strong> Since <code>DeliverTx</code> is an ABCI call, <code>Tx</code> is received in the encoded <code>[]byte</code> form. Nodes first unmarshal the transaction, using the <code>TxConfig</code> defined in the app, then call <code>runTx</code> in <code>runTxModeDeliver</code>, which is very similar to <code>CheckTx</code> but also executes and writes state changes.</p></li><li><p><strong>Checks and AnteHandler:</strong> Full-nodes call <code>validateBasicMsgs</code> and <code>AnteHandler</code> again. This second check happens because they may not have seen the same transactions during the addition to Mempool stage and a malicious proposer may have included invalid ones. One difference here is that the <code>AnteHandler</code> will not compare <code>gas-prices</code> to the node&#39;s <code>min-gas-prices</code> since that value is local to each node - differing values across nodes would yield nondeterministic results.</p></li><li><p><strong><code>MsgServiceRouter</code>:</strong> While <code>CheckTx</code> would have exited, <code>DeliverTx</code> continues to run <code>runMsgs</code> to fully execute each <code>Msg</code> within the transaction. Since the transaction may have messages from different modules, <code>BaseApp</code> needs to know which module to find the appropriate handler. This is achieved using <code>BaseApp</code>&#39;s <code>MsgServiceRouter</code> so that it can be processed by the module&#39;s Protobuf <code>Msg</code> service.</p></li><li><p><strong><code>Msg</code> service:</strong> Protobuf <code>Msg</code> service is responsible for executing each message in the <code>Tx</code> and causes state transitions to persist in <code>deliverTxState</code>.</p></li><li><p><strong>PostHandlers:</strong> <code>PostHandler</code>s run after the execution of the message. If they fail, the state change of <code>runMsgs</code>, as well of <code>PostHandlers</code> are both reverted.</p></li><li><p><strong>Gas:</strong> While a <code>Tx</code> is being delivered, a <code>GasMeter</code> is used to keep track of how much gas is being used; if execution completes, <code>GasUsed</code> is set and returned to the <code>abci.ResponseDeliverTx</code>. If execution halts because <code>BlockGasMeter</code> or <code>GasMeter</code> has run out or something else goes wrong, a deferred function at the end appropriately errors or panics.</p></li></ul><p>If there are any failed state changes resulting from a <code>Tx</code> being invalid or <code>GasMeter</code> running out, the transaction processing terminates and any state changes are reverted. Invalid transactions in a block proposal cause validator nodes to reject the block and vote for a <code>nil</code> block instead.</p><h3 id="commit" tabindex="-1"><a class="header-anchor" href="#commit" aria-hidden="true">#</a> Commit</h3><p>The final step is for nodes to commit the block and state changes. Validator nodes perform the previous step of executing state transitions in order to validate the transactions, then sign the block to confirm it. Full nodes that are not validators do not participate in consensus - i.e. they cannot vote - but listen for votes to understand whether they should commit the state changes.</p><p>When they receive enough validator votes (2/3+ <em>precommits</em> weighted by voting power), full nodes commit to a new block to be added to the blockchain and finalize the state transitions in the application layer. A new state root is generated to serve as a merkle proof for the state transitions. Applications use the <code>Commit</code> ABCI method inherited from Baseapp; it syncs all the state transitions by writing the <code>deliverState</code> into the application&#39;s internal state. As soon as the state changes are committed, <code>checkState</code> start afresh from the most recently committed state and <code>deliverState</code> resets to <code>nil</code> in order to be consistent and reflect the changes.</p><p>Note that not all blocks have the same number of transactions, and it is possible for consensus to result in a <code>nil</code> block or one with none at all. In a public blockchain network, it is also possible for validators to be <strong>byzantine</strong>, or malicious, which may prevent a <code>Tx</code> from being committed in the blockchain. Possible malicious behaviors include the proposer deciding to censor a <code>Tx</code> by excluding it from the block or a validator voting against the block.</p><p>At this point, the transaction lifecycle of a <code>Tx</code> is over: nodes have verified its validity, delivered it by executing its state changes, and committed those changes. The <code>Tx</code> itself, in <code>[]byte</code> form, is stored in a block and appended to the blockchain.</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/bnb-chain/greenfield-docs/edit/master/src/docs/concept/transaction-lifecycle.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">Last update: </span><!----></div><div class="contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: 296179868@qq.com">zjubfd</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/docs/concept/programmability.html" class="nav-link prev" aria-label="Programmability"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->Programmability</div></a><!----></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Copyright © 2023 BNB-Chain.</div><!----></footer></div><!--]--><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-07a3b8c6.js" defer></script>
  </body>
</html>
